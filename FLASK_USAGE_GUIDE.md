# Flask 웹 인터페이스 사용 가이드

이 가이드는 Unified ROI Tracker의 Flask 웹 인터페이스 사용법을 설명합니다.

## 🚀 **설치 및 실행**

### 1. **의존성 설치**
```bash
pip install -r requirements_flask.txt
```

### 2. **Flask 앱 실행**
```bash
python flask_app.py
```

### 3. **웹 브라우저 접속**
```
http://localhost:5000
```

## 🖥️ **웹 인터페이스 기능**

### **메인 화면 구성**
- **왼쪽**: 실시간 비디오 스트림
- **오른쪽**: 제어 패널 및 통계

### **비디오 스트림**
- 실시간 카메라 피드 표시
- 헬멧 검출 결과 시각화
- ROI 위험 구역 표시
- 추적 ID 및 상태 표시

## 🎮 **제어 기능**

### **기본 제어**
- **시작**: 추적 시스템 시작
- **정지**: 추적 시스템 정지
- **리셋**: 추적기 상태 초기화
- **ROI 지우기**: 현재 ROI 제거

### **실시간 설정 조정**
- **신뢰도 임계값**: 0.1 ~ 0.9 (슬라이더)
- **IoU 임계값**: 0.1 ~ 0.9 (슬라이더)
- **검출 간격**: 1~5프레임마다
- **장치**: 자동/CUDA/CPU

## 📊 **실시간 통계**

### **표시되는 통계**
- **검출된 사람**: 현재 프레임에서 검출된 사람 수
- **헬멧 착용**: 헬멧을 착용한 사람 수
- **헬멧 미착용**: 헬멧을 착용하지 않은 사람 수
- **위험 구역**: ROI 내부에 있는 사람 수
- **활성 추적**: 현재 추적 중인 객체 수
- **총 위험 이벤트**: 누적 위험 이벤트 수

### **상태 표시**
- 🟢 **실행 중**: 시스템이 정상 작동 중
- 🔴 **정지됨**: 시스템이 정지된 상태

## ⚙️ **고급 설정**

### **성능 최적화 설정**
```bash
# 고속 모드 (웹 인터페이스용)
신뢰도: 0.3
IoU: 0.2
검출 간격: 3프레임마다
장치: CUDA
```

### **정확도 우선 설정**
```bash
# 정확도 모드
신뢰도: 0.5
IoU: 0.4
검출 간격: 1프레임마다
장치: CUDA
```

## 🔧 **API 엔드포인트**

### **통계 조회**
```bash
GET /api/stats
```

### **설정 조회/변경**
```bash
GET /api/config
POST /api/config
```

### **제어 명령**
```bash
POST /api/control
{
    "action": "start|stop|reset|clear_roi"
}
```

### **ROI 설정**
```bash
POST /api/roi
{
    "points": [[x1, y1], [x2, y2], [x3, y3], ...]
}
```

## 📱 **모바일 지원**

웹 인터페이스는 반응형 디자인으로 모바일 기기에서도 사용 가능합니다:
- 터치 친화적 인터페이스
- 모바일 최적화된 레이아웃
- 실시간 통계 표시

## 🔒 **보안 고려사항**

### **네트워크 보안**
```bash
# 로컬 네트워크에서만 접근 허용
app.run(host='127.0.0.1', port=5000)

# 외부 접근 허용 (주의 필요)
app.run(host='0.0.0.0', port=5000)
```

### **방화벽 설정**
```bash
# Ubuntu/Debian
sudo ufw allow 5000

# CentOS/RHEL
sudo firewall-cmd --permanent --add-port=5000/tcp
sudo firewall-cmd --reload
```

## 🐛 **문제 해결**

### **카메라 접근 오류**
```bash
# 권한 확인
ls -l /dev/video*

# 사용자를 video 그룹에 추가
sudo usermod -a -G video $USER
```

### **포트 충돌**
```bash
# 다른 포트 사용
python flask_app.py --port 8080
```

### **메모리 부족**
```bash
# 검출 간격 증가
# GPU 메모리 모니터링
nvidia-smi
```

## 📈 **성능 모니터링**

### **웹 브라우저 개발자 도구**
- F12 → Network 탭: API 응답 시간 확인
- F12 → Console 탭: JavaScript 오류 확인

### **서버 로그**
```bash
# Flask 앱 실행 시 로그 확인
python flask_app.py 2>&1 | tee app.log
```

## 🎯 **사용 사례**

### **실시간 모니터링**
- 건설 현장 안전 감시
- 공장 안전 구역 모니터링
- 이벤트장 안전 관리

### **데이터 수집**
- 안전 통계 수집
- 위험 이벤트 분석
- 성능 최적화 데이터

### **원격 감시**
- 여러 지점 동시 모니터링
- 모바일 기기로 원격 접근
- 실시간 알림 시스템

## 🔄 **업데이트 및 유지보수**

### **정기 업데이트**
```bash
# 의존성 업데이트
pip install --upgrade -r requirements_flask.txt

# 코드 업데이트
git pull origin main
```

### **백업 및 복구**
```bash
# 설정 백업
cp flask_app.py flask_app.py.backup

# 데이터베이스 백업 (필요시)
# 통계 데이터 백업
```

이 Flask 웹 인터페이스를 통해 Unified ROI Tracker를 웹 브라우저에서 편리하게 사용할 수 있습니다! 